**Прогнозирование забойного давления (BHP) с использованием стекинга**

Этот проект реализует модель машинного обучения для прогнозирования забойного давления (BHP) скважин на основе исторических данных. Используется подход стекинга, объединяющий три базовые модели (RandomForest, GradientBoosting, DecisionTree) с мета-моделью LinearRegression для повышения точности прогнозов. Проект включает визуализацию важности признаков (тепловая карта) и временных рядов параметров скважин (BHP, WHP, Gas Rate, Choke Size).

**Зачем стекинг?**

Изначально было установлено, что отдельные модели (RandomForest, GradientBoosting, DecisionTree) показывают хорошие результаты при прогнозировании исторических значений BHP, но каждая из них лучше справляется с определенными аспектами данных. RandomForest эффективно улавливает нелинейные зависимости, GradientBoosting последовательно улучшает предсказания, а DecisionTree обеспечивает интерпретируемость. Для объединения их сильных сторон и повышения точности был применен стекинг, где мета-модель (LinearRegression) комбинирует предсказания базовых моделей.

**Требования**
- Python 3.8+

**Зависимости:**
- pandas>=2.0.0
- numpy>=1.24.0
- scikit-learn>=1.2.0
- seaborn>=0.12.0
- matplotlib>=3.7.0
- plotly>=5.10.0
- jupyter>=1.0.0

**Структура данных**
Проект использует два CSV-файла:
- teach_data.csv: Обучающий набор данных с колонками:
  - Well Name: Название скважины (строка)
  - Last: Дата в формате DD.MM.YY (например, 01.01.25)
  - BHP: Забойное давление (целевая переменная, число)
  - Choke, WHP, Gas, ...: Признаки (числа)
- forecast.csv: Данные для прогнозирования с аналогичной структурой.

**Описание проекта**

Jupyter Notebook (notebooks/bhp_prediction.ipynb) выполняет следующие шаги:
- Загрузка и предобработка данных: Удаление пропусков, фильтрация выбросов по IQR, преобразование типов данных.
- Обучение базовых моделей: RandomForest, GradientBoosting, DecisionTree.
- Анализ важности признаков: Построение тепловой карты с помощью seaborn.
- Стекинг: Обучение мета-модели LinearRegression на предсказаниях базовых моделей с использованием кросс-валидации.
- Оценка модели: Вычисление MSE и R² на тестовой выборке.
- Прогнозирование: Прогноз BHP для новых данных (forecast.csv) с выводом в виде таблицы.
- Визуализация: Два подграфика:
  - Первый: Временные ряды прогнозируемого BHP и WHP для каждой скважины.
  - Второй: Gas Rate (основная ось Y) и Choke Size (вторичная ось Y).

**Вывод**
- Таблица прогнозов: Содержит Well Name, Date, Predicted BHP (округлено до 1 знака после запятой).
- Графики: Интерактивные подграфики, созданные с помощью Plotly, отображаются в Jupyter Notebook. Для просмотра вне Jupyter откройте notebooks/bhp_prediction_plot.html (если сохранен).

**Контакты**
- Имя: Павел Цицер
- Email: tsitsero@gmail.com
